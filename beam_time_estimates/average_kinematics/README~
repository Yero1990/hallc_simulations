Here is the python code to calculate the
averaged kinematics using an input analyzed SIMC
file with selected histograms at the vertex (not reconstructed)

This code a weighted average HISTOGRAM over kinematic variable X
The histogram is generated by the analysis code for SIMC and in that
code is calculated as follows:

# within the event loop, fill a 2D histogram in bins of missing momentum (Pm)
# and neutron recoil angle (thrq) weighted by kinematic variable X
H_Pm_vs_thrq->Fill(thrq, Pm, X * FullWeight)


Then, outside the event loop