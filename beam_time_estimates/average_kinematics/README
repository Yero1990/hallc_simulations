Here is the python code to calculate the
averaged kinematics using an input analyzed SIMC
file with selected histograms at the vertex (not reconstructed)

This code a weighted average HISTOGRAM over kinematic variable X
The histogram is generated by the analysis code for SIMC and in that
code is calculated as follows:

# -------------------------------

TH2F * H_X_2Davg = new TH2F (. .  . )

# within the event loop, fill a 2D histogram in bins of
# missing momentum (Pm_v)  and neutron recoil angle (th_rq_v)
# weighted by kinematic variable X at the vertex (hence the '_v')

# standard 2D histogram for average calculation (denominated of weighted avg)
H_Pm_vs_thrq_v    ->Fill(th_rq_v/dtr, Pm_v, FullWeight);	

# fill the histogram with events weighted by kin. variable X
H_X_2Davg    -> Fill(th_rq_v/dtr, Pm_v, X_v*FullWeight);


Then, outside the event loop (after all histograms filled)
# divide by the 2D histogram over which the variable X was filled

H_X_2Davg    -> Divide(H_Pm_vs_thrq_v);

# -----------------------------------

Mathematically, this is equivalent to summing over all data points i:
which is the standard weighted average formula
X_weighted =  sum_i [ X_i * weight_i ] /  sum_i [weight_i]
